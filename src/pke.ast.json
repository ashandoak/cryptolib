{"ast":[null,{"children":[0,2,11],"kind":"file","start":[0,0]},{"children":[3,5,7,9],"end":[7,0],"kind":"imports","start":[7,0]},{"children":[4],"end":[7,0],"kind":"import","start":[7,0]},{"end":[7,7],"kind":"module","start":[7,7],"value":["data","zmod","basic"]},{"children":[6],"end":[8,0],"kind":"import","start":[8,0]},{"end":[8,7],"kind":"module","start":[8,7],"value":["probability","probability_mass_function","basic"]},{"children":[8],"end":[9,0],"kind":"import","start":[9,0]},{"end":[9,7],"kind":"module","start":[9,7],"value":"to_mathlib"},{"children":[10],"end":[10,0],"kind":"import","start":[10,0]},{"end":[10,7],"kind":"module","start":[10,7],"value":"uniform"},{"children":[15,16,93,146,171,254,273],"end":[10,7],"kind":"commands","start":[10,7]},{"end":[12,20],"kind":"noncomputable","start":[12,0]},{"children":[12],"end":[12,0],"kind":"modifiers","start":[12,0]},null,{"children":[13],"end":[12,14],"kind":"theory","start":[12,14]},{"children":[0,17,26,32,43,54,62,77],"end":[24,43],"kind":"variables","start":[19,0]},{"children":[18,0,25],"end":[19,11],"kind":"binder_4","start":[19,10]},{"children":[19,20,21,22,23],"end":[19,11],"kind":"vars","start":[19,10]},{"end":[19,11],"kind":"ident","start":[19,11],"value":"G1"},{"end":[19,14],"kind":"ident","start":[19,14],"value":"G2"},{"end":[19,17],"kind":"ident","start":[19,17],"value":"M"},{"end":[19,19],"kind":"ident","start":[19,19],"value":"C"},{"end":[19,21],"kind":"ident","start":[19,21],"value":"A_state"},{"children":[0],"end":[19,34],"kind":"Type","pexpr":2,"start":[19,30]},{"children":[24],"end":[19,34],"expr":1,"kind":"notation","pexpr":2,"start":[19,30],"value":"Type"},{"children":[0,0,31],"end":[19,37],"kind":"binder_1","start":[19,36]},null,{"end":[19,37],"kind":"ident","start":[19,37],"value":"decidable_eq"},{"children":[28,0],"end":[19,49],"kind":"const","pexpr":3,"start":[19,37]},{"end":[19,51],"kind":"ident","pexpr":4,"start":[19,50],"value":"M"},{"children":[29,30],"end":[19,51],"expr":8,"kind":"app","pexpr":5,"start":[19,37]},{"children":[33,0,42],"end":[20,11],"kind":"binder_0","start":[20,10]},{"children":[34],"end":[20,11],"kind":"vars","start":[20,10]},{"end":[20,11],"kind":"ident","start":[20,11],"value":"keygen"},{"end":[20,20],"kind":"ident","start":[20,20],"value":"pmf"},{"children":[35,0],"end":[20,23],"kind":"const","pexpr":9,"start":[20,20]},{"end":[20,27],"kind":"ident","pexpr":10,"start":[20,25],"value":"G1"},{"end":[20,32],"kind":"ident","pexpr":11,"start":[20,30],"value":"G2"},{"children":[37,38],"end":[20,32],"kind":"notation","pexpr":14,"start":[20,28],"value":"expr × "},{"children":[39],"end":[20,33],"kind":"(","pexpr":14,"start":[20,24]},{"children":[40],"end":[20,33],"kind":"notation","pexpr":14,"start":[20,24],"value":"("},{"children":[36,41],"end":[20,33],"expr":22,"kind":"app","pexpr":15,"start":[20,20]},{"children":[44,0,53],"end":[21,11],"kind":"binder_0","start":[21,10]},{"children":[45],"end":[21,11],"kind":"vars","start":[21,10]},{"end":[21,11],"kind":"ident","start":[21,11],"value":"encrypt"},{"end":[21,23],"kind":"ident","pexpr":23,"start":[21,21],"value":"G1"},{"end":[21,27],"kind":"ident","pexpr":24,"start":[21,26],"value":"M"},{"end":[21,30],"kind":"ident","start":[21,30],"value":"pmf"},{"children":[48,0],"end":[21,33],"kind":"const","pexpr":25,"start":[21,30]},{"end":[21,35],"kind":"ident","pexpr":26,"start":[21,34],"value":"C"},{"children":[49,50],"end":[21,35],"kind":"app","pexpr":27,"start":[21,30]},{"children":[47,51],"end":[21,35],"kind":"notation","pexpr":28,"start":[21,28],"value":"->"},{"children":[46,52],"end":[21,35],"expr":34,"kind":"notation","pexpr":29,"start":[21,24],"value":"->"},{"children":[55,0,61],"end":[22,11],"kind":"binder_0","start":[22,10]},{"children":[56],"end":[22,11],"kind":"vars","start":[22,10]},{"end":[22,11],"kind":"ident","start":[22,11],"value":"decrypt"},{"end":[22,23],"kind":"ident","pexpr":35,"start":[22,21],"value":"G2"},{"end":[22,27],"kind":"ident","pexpr":36,"start":[22,26],"value":"C"},{"end":[22,31],"kind":"ident","pexpr":37,"start":[22,30],"value":"M"},{"children":[58,59],"end":[22,31],"kind":"notation","pexpr":38,"start":[22,28],"value":"->"},{"children":[57,60],"end":[22,31],"expr":41,"kind":"notation","pexpr":39,"start":[22,24],"value":"->"},{"children":[63,0,76],"end":[23,11],"kind":"binder_0","start":[23,10]},{"children":[64],"end":[23,11],"kind":"vars","start":[23,10]},{"end":[23,11],"kind":"ident","start":[23,11],"value":"A1"},{"end":[23,18],"kind":"ident","pexpr":42,"start":[23,16],"value":"G1"},{"end":[23,21],"kind":"ident","start":[23,21],"value":"pmf"},{"children":[66,0],"end":[23,24],"kind":"const","pexpr":43,"start":[23,21]},{"end":[23,27],"kind":"ident","pexpr":44,"start":[23,26],"value":"M"},{"end":[23,31],"kind":"ident","pexpr":45,"start":[23,30],"value":"M"},{"end":[23,41],"kind":"ident","pexpr":46,"start":[23,34],"value":"A_state"},{"children":[69,70],"end":[23,41],"kind":"notation","pexpr":49,"start":[23,32],"value":"expr × "},{"children":[68,71],"end":[23,41],"kind":"notation","pexpr":52,"start":[23,28],"value":"expr × "},{"children":[72],"end":[23,42],"kind":"(","pexpr":52,"start":[23,25]},{"children":[73],"end":[23,42],"kind":"notation","pexpr":52,"start":[23,25],"value":"("},{"children":[67,74],"end":[23,42],"kind":"app","pexpr":53,"start":[23,21]},{"children":[65,75],"end":[23,42],"expr":62,"kind":"notation","pexpr":54,"start":[23,19],"value":"->"},{"children":[78,0,92],"end":[24,11],"kind":"binder_0","start":[24,10]},{"children":[79],"end":[24,11],"kind":"vars","start":[24,10]},{"end":[24,11],"kind":"ident","start":[24,11],"value":"A2"},{"end":[24,17],"kind":"ident","pexpr":63,"start":[24,16],"value":"C"},{"end":[24,27],"kind":"ident","pexpr":64,"start":[24,20],"value":"A_state"},{"end":[24,30],"kind":"ident","start":[24,30],"value":"pmf"},{"children":[82,0],"end":[24,33],"kind":"const","pexpr":65,"start":[24,30]},{"end":[24,35],"kind":"ident","start":[24,35],"value":"zmod"},{"children":[84,0],"end":[24,39],"kind":"const","pexpr":66,"start":[24,35]},{"end":[24,41],"kind":"nat","pexpr":67,"start":[24,40],"value":"2"},{"children":[85,86],"end":[24,41],"kind":"app","pexpr":68,"start":[24,35]},{"children":[87],"end":[24,42],"kind":"(","pexpr":68,"start":[24,34]},{"children":[88],"end":[24,42],"kind":"notation","pexpr":68,"start":[24,34],"value":"("},{"children":[83,89],"end":[24,42],"kind":"app","pexpr":69,"start":[24,30]},{"children":[81,90],"end":[24,42],"kind":"notation","pexpr":70,"start":[24,28],"value":"->"},{"children":[80,91],"end":[24,42],"expr":86,"kind":"notation","pexpr":71,"start":[24,18],"value":"->"},{"children":[0,0,0,94,95,108,145,0],"end":[36,43],"kind":"definition","start":[32,0]},{"end":[32,4],"kind":"ident","start":[32,4],"value":"enc_dec"},{"children":[97],"end":[32,13],"kind":"binders","start":[32,13]},{"children":[98],"end":[32,14],"kind":"vars","start":[32,14]},{"children":[96,0,99],"end":[32,14],"kind":"binder_0","start":[32,14]},{"end":[32,14],"kind":"ident","start":[32,14],"value":"m"},{"end":[32,19],"kind":"ident","pexpr":87,"start":[32,18],"value":"M"},{"end":[32,23],"kind":"ident","start":[32,23],"value":"pmf"},{"children":[100,0],"end":[32,26],"kind":"const","pexpr":88,"start":[32,23]},{"end":[32,28],"kind":"ident","start":[32,28],"value":"zmod"},{"children":[102,0],"end":[32,32],"kind":"const","pexpr":89,"start":[32,28]},{"end":[32,34],"kind":"nat","pexpr":90,"start":[32,33],"value":"2"},{"children":[103,104],"end":[32,34],"kind":"app","pexpr":91,"start":[32,28]},{"children":[105],"end":[32,35],"kind":"(","pexpr":91,"start":[32,27]},{"children":[106],"end":[32,35],"kind":"notation","pexpr":91,"start":[32,27],"value":"("},{"children":[101,107],"end":[32,35],"kind":"app","pexpr":92,"start":[32,23]},{"children":[112,121,140],"end":[36,43],"kind":"do","pexpr":129,"start":[33,0]},{"end":[34,5],"kind":"ident","pexpr":131,"start":[34,2],"value":"k"},{"end":[34,12],"kind":"ident","pexpr":95,"start":[34,6],"value":"keygen"},{"children":[110,0,111,0],"end":[34,12],"kind":"<-","start":[34,2]},{"end":[35,5],"kind":"ident","pexpr":133,"start":[35,2],"value":"c"},{"end":[35,13],"kind":"ident","pexpr":100,"start":[35,6],"value":"encrypt"},{"end":[35,15],"kind":"ident","pexpr":134,"start":[35,14],"value":"k"},{"end":[35,15],"kind":"nat","start":[35,15],"value":"1"},{"children":[115,116],"end":[35,15],"kind":"field","pexpr":135,"start":[35,14]},{"children":[114,117],"end":[35,17],"kind":"app","pexpr":136,"start":[35,6]},{"end":[35,19],"kind":"ident","pexpr":104,"start":[35,18],"value":"m"},{"children":[118,119],"end":[35,19],"kind":"app","pexpr":137,"start":[35,6]},{"children":[113,0,120,0],"end":[35,19],"kind":"<-","start":[35,2]},{"end":[36,6],"kind":"ident","pexpr":139,"start":[36,2],"value":"pure"},{"end":[36,43],"kind":"ident","pexpr":111,"start":[36,11],"value":"decrypt"},{"end":[36,43],"kind":"ident","pexpr":140,"start":[36,19],"value":"k"},{"end":[36,20],"kind":"nat","start":[36,20],"value":"2"},{"children":[124,125],"end":[36,20],"kind":"field","pexpr":143,"start":[36,19]},{"children":[123,126],"end":[36,22],"kind":"app","pexpr":146,"start":[36,11]},{"end":[36,43],"kind":"ident","pexpr":147,"start":[36,23],"value":"c"},{"children":[127,128],"end":[36,24],"kind":"app","pexpr":150,"start":[36,11]},{"end":[36,43],"kind":"ident","pexpr":118,"start":[36,27],"value":"m"},{"children":[129,130],"end":[36,28],"kind":"notation","pexpr":154,"start":[36,25],"value":"expr = "},{"children":[0,131,133,134],"end":[36,42],"kind":"if","pexpr":157,"start":[36,8]},{"end":[36,35],"kind":"nat","pexpr":121,"start":[36,34],"value":"1"},{"end":[36,42],"kind":"nat","pexpr":123,"start":[36,41],"value":"0"},{"children":[132],"end":[36,42],"kind":"notation","pexpr":157,"start":[36,8],"value":"if"},{"children":[135],"end":[36,43],"kind":"(","pexpr":157,"start":[36,7]},{"children":[136],"end":[36,43],"kind":"notation","pexpr":157,"start":[36,7],"value":"("},{"children":[122,137],"end":[36,43],"kind":"app","pexpr":158,"start":[36,2]},null,{"children":[138],"end":[43,0],"kind":"eval","start":[36,2]},null,null,null,null,{"children":[109],"end":[36,43],"kind":"notation","pexpr":129,"start":[33,0],"value":"do"},{"children":[0,0,0,147,0,149,170,0],"end":[43,82],"kind":"definition","start":[43,0]},{"end":[43,4],"kind":"ident","start":[43,4],"value":"pke_correctness"},null,{"end":[43,26],"kind":"notation","pexpr":159,"start":[43,22],"value":"exprProp"},{"children":[152],"end":[43,32],"kind":"binders","start":[43,32]},{"children":[153],"end":[43,33],"kind":"vars","start":[43,33]},{"children":[151,0,154],"end":[43,33],"kind":"binder_0","start":[43,33]},{"end":[43,33],"kind":"ident","start":[43,33],"value":"m"},{"end":[43,38],"kind":"ident","pexpr":160,"start":[43,37],"value":"M"},{"end":[43,41],"kind":"ident","start":[43,41],"value":"enc_dec"},{"children":[155,0],"end":[43,48],"kind":"const","pexpr":161,"start":[43,41]},{"end":[43,55],"kind":"ident","pexpr":162,"start":[43,49],"value":"keygen"},{"children":[156,157],"end":[43,55],"kind":"app","pexpr":163,"start":[43,41]},{"end":[43,63],"kind":"ident","pexpr":164,"start":[43,56],"value":"encrypt"},{"children":[158,159],"end":[43,63],"kind":"app","pexpr":165,"start":[43,41]},{"end":[43,71],"kind":"ident","pexpr":166,"start":[43,64],"value":"decrypt"},{"children":[160,161],"end":[43,71],"kind":"app","pexpr":167,"start":[43,41]},{"end":[43,73],"kind":"ident","pexpr":168,"start":[43,72],"value":"m"},{"children":[162,163],"end":[43,73],"kind":"app","pexpr":169,"start":[43,41]},{"end":[43,76],"kind":"ident","start":[43,76],"value":"pure"},{"children":[165,0],"end":[43,80],"kind":"const","pexpr":170,"start":[43,76]},{"end":[43,82],"kind":"nat","pexpr":171,"start":[43,81],"value":"1"},{"children":[166,167],"end":[43,82],"kind":"app","pexpr":172,"start":[43,76]},{"children":[164,168],"end":[43,82],"kind":"notation","pexpr":175,"start":[43,74],"value":"expr = "},{"children":[150,169],"end":[43,82],"kind":"notation","pexpr":180,"start":[43,30],"value":"Pi"},{"children":[0,0,0,172,0,182,253,0],"end":[56,19],"kind":"definition","start":[49,0]},{"end":[49,4],"kind":"ident","start":[49,4],"value":"SSG"},null,{"end":[49,10],"kind":"ident","start":[49,10],"value":"pmf"},{"children":[174,0],"end":[49,13],"kind":"const","pexpr":181,"start":[49,10]},{"end":[49,15],"kind":"ident","start":[49,15],"value":"zmod"},{"children":[176,0],"end":[49,19],"kind":"const","pexpr":182,"start":[49,15]},{"end":[49,21],"kind":"nat","pexpr":183,"start":[49,20],"value":"2"},{"children":[177,178],"end":[49,21],"kind":"app","pexpr":184,"start":[49,15]},{"children":[179],"end":[49,22],"kind":"(","pexpr":184,"start":[49,14]},{"children":[180],"end":[49,22],"kind":"notation","pexpr":184,"start":[49,14],"value":"("},{"children":[175,181],"end":[49,22],"kind":"app","pexpr":185,"start":[49,10]},{"children":[186,193,197,220,231,242],"end":[56,19],"kind":"do","pexpr":258,"start":[50,0]},{"end":[51,5],"kind":"ident","pexpr":260,"start":[51,2],"value":"k"},{"end":[51,12],"kind":"ident","pexpr":188,"start":[51,6],"value":"keygen"},{"children":[184,0,185,0],"end":[51,12],"kind":"<-","start":[51,2]},{"end":[52,5],"kind":"ident","pexpr":262,"start":[52,2],"value":"m"},{"end":[52,8],"kind":"ident","pexpr":193,"start":[52,6],"value":"A1"},{"end":[52,10],"kind":"ident","pexpr":263,"start":[52,9],"value":"k"},{"end":[52,10],"kind":"nat","start":[52,10],"value":"1"},{"children":[189,190],"end":[52,10],"kind":"field","pexpr":264,"start":[52,9]},{"children":[188,191],"end":[52,12],"kind":"app","pexpr":265,"start":[52,6]},{"children":[187,0,192,0],"end":[52,12],"kind":"<-","start":[52,2]},{"end":[53,5],"kind":"ident","pexpr":267,"start":[53,2],"value":"b"},{"end":[53,6],"kind":"ident","start":[53,6],"value":"uniform_2"},{"children":[195,0],"end":[53,15],"kind":"const","pexpr":201,"start":[53,6]},{"children":[194,0,196,0],"end":[53,15],"kind":"<-","start":[53,2]},{"end":[54,5],"kind":"ident","pexpr":269,"start":[54,2],"value":"c"},{"end":[54,13],"kind":"ident","pexpr":206,"start":[54,6],"value":"encrypt"},{"end":[54,15],"kind":"ident","pexpr":270,"start":[54,14],"value":"k"},{"end":[54,15],"kind":"nat","start":[54,15],"value":"1"},{"children":[200,201],"end":[54,15],"kind":"field","pexpr":271,"start":[54,14]},{"children":[199,202],"end":[54,17],"kind":"app","pexpr":272,"start":[54,6]},{"end":[54,23],"kind":"ident","pexpr":273,"start":[54,22],"value":"b"},{"end":[54,27],"kind":"nat","pexpr":214,"start":[54,26],"value":"0"},{"children":[204,205],"end":[54,27],"kind":"notation","pexpr":275,"start":[54,24],"value":"expr = "},{"children":[0,206,210,215],"end":[54,47],"kind":"if","pexpr":283,"start":[54,19]},{"end":[54,34],"kind":"ident","pexpr":277,"start":[54,33],"value":"m"},{"end":[54,34],"kind":"nat","start":[54,34],"value":"1"},{"children":[208,209],"end":[54,34],"kind":"field","pexpr":278,"start":[54,33]},{"end":[54,43],"kind":"ident","pexpr":280,"start":[54,42],"value":"m"},{"end":[54,43],"kind":"nat","start":[54,43],"value":"2"},{"children":[211,212],"end":[54,43],"kind":"field","pexpr":281,"start":[54,42]},{"end":[54,45],"kind":"nat","start":[54,45],"value":"1"},{"children":[213,214],"end":[54,45],"kind":"field","pexpr":282,"start":[54,42]},{"children":[207],"end":[54,47],"kind":"notation","pexpr":283,"start":[54,19],"value":"if"},{"children":[216],"end":[54,48],"kind":"(","pexpr":283,"start":[54,18]},{"children":[217],"end":[54,48],"kind":"notation","pexpr":283,"start":[54,18],"value":"("},{"children":[203,218],"end":[54,48],"kind":"app","pexpr":284,"start":[54,6]},{"children":[198,0,219,0],"end":[54,48],"kind":"<-","start":[54,2]},{"end":[55,6],"kind":"ident","pexpr":286,"start":[55,2],"value":"b'"},{"end":[55,9],"kind":"ident","pexpr":229,"start":[55,7],"value":"A2"},{"end":[55,11],"kind":"ident","pexpr":287,"start":[55,10],"value":"c"},{"children":[222,223],"end":[55,11],"kind":"app","pexpr":288,"start":[55,7]},{"end":[55,13],"kind":"ident","pexpr":289,"start":[55,12],"value":"m"},{"end":[55,13],"kind":"nat","start":[55,13],"value":"2"},{"children":[225,226],"end":[55,13],"kind":"field","pexpr":290,"start":[55,12]},{"end":[55,15],"kind":"nat","start":[55,15],"value":"2"},{"children":[227,228],"end":[55,15],"kind":"field","pexpr":291,"start":[55,12]},{"children":[224,229],"end":[55,17],"kind":"app","pexpr":292,"start":[55,7]},{"children":[221,0,230,0],"end":[55,17],"kind":"<-","start":[55,2]},{"end":[56,6],"kind":"ident","pexpr":294,"start":[56,2],"value":"pure"},{"end":[56,9],"kind":"nat","pexpr":241,"start":[56,8],"value":"1"},{"end":[56,19],"kind":"ident","pexpr":295,"start":[56,12],"value":"b"},{"children":[233,234],"end":[56,13],"kind":"notation","pexpr":298,"start":[56,10],"value":"expr + "},{"end":[56,19],"kind":"ident","pexpr":299,"start":[56,16],"value":"b'"},{"children":[235,236],"end":[56,18],"kind":"notation","pexpr":303,"start":[56,14],"value":"expr + "},{"children":[237],"end":[56,19],"kind":"(","pexpr":303,"start":[56,7]},{"children":[238],"end":[56,19],"kind":"notation","pexpr":303,"start":[56,7],"value":"("},{"children":[232,239],"end":[56,19],"kind":"app","pexpr":304,"start":[56,2]},null,{"children":[240],"end":[59,0],"kind":"eval","start":[56,2]},null,null,null,null,null,null,null,null,null,null,{"children":[183],"end":[56,19],"kind":"notation","pexpr":258,"start":[50,0],"value":"do"},{"children":[255,0,0,256,272],"end":[59,59],"kind":"notation","start":[59,0]},{"end":[59,6],"kind":"local","start":[59,6]},{"children":[257],"end":[59,15],"kind":"args","start":[59,15]},{"children":[258,0],"end":[59,15],"kind":"sym","start":[59,15]},{"end":[59,15],"kind":"quoted","start":[59,15],"value":"Pr[SSG(A)]"},{"end":[59,32],"kind":"ident","start":[59,32],"value":"SSG"},{"children":[259,0],"end":[59,35],"kind":"const","pexpr":305,"start":[59,32]},{"end":[59,42],"kind":"ident","pexpr":306,"start":[59,36],"value":"keygen"},{"children":[260,261],"end":[59,42],"kind":"app","pexpr":307,"start":[59,32]},{"end":[59,50],"kind":"ident","pexpr":308,"start":[59,43],"value":"encrypt"},{"children":[262,263],"end":[59,50],"kind":"app","pexpr":309,"start":[59,32]},{"end":[59,53],"kind":"ident","pexpr":310,"start":[59,51],"value":"A1"},{"children":[264,265],"end":[59,53],"kind":"app","pexpr":311,"start":[59,32]},{"end":[59,56],"kind":"ident","pexpr":312,"start":[59,54],"value":"A2"},{"children":[266,267],"end":[59,56],"kind":"app","pexpr":313,"start":[59,32]},{"end":[59,58],"kind":"nat","pexpr":314,"start":[59,57],"value":"1"},{"children":[268,269],"end":[59,58],"kind":"app","pexpr":315,"start":[59,32]},{"children":[270],"end":[59,59],"kind":"(","pexpr":315,"start":[59,31]},{"children":[271],"end":[59,59],"kind":"notation","pexpr":315,"start":[59,31],"value":"("},{"children":[0,0,0,274,275,281,293,0],"end":[61,75],"kind":"definition","start":[61,0]},{"end":[61,4],"kind":"ident","start":[61,4],"value":"pke_semantic_security"},{"children":[277],"end":[61,26],"kind":"binders","start":[61,26]},{"children":[278],"end":[61,27],"kind":"vars","start":[61,27]},{"children":[276,0,280],"end":[61,27],"kind":"binder_0","start":[61,27]},{"end":[61,27],"kind":"ident","start":[61,27],"value":"ε"},{"end":[61,31],"kind":"ident","start":[61,31],"value":"nnreal"},{"children":[279,0],"end":[61,37],"kind":"const","pexpr":316,"start":[61,31]},{"end":[61,45],"kind":"notation","pexpr":317,"start":[61,41],"value":"exprProp"},{"end":[61,49],"kind":"ident","start":[61,49],"value":"abs"},{"children":[282,0],"end":[61,52],"kind":"const","pexpr":318,"start":[61,49]},{"end":[61,64],"kind":"notation","pexpr":329,"start":[61,54],"value":"exprPr[SSG(A)]"},{"end":[61,68],"kind":"nat","pexpr":330,"start":[61,67],"value":"1"},{"end":[61,70],"kind":"nat","pexpr":331,"start":[61,69],"value":"2"},{"children":[285,286],"end":[61,70],"kind":"notation","pexpr":334,"start":[61,68],"value":"expr / "},{"children":[284,287],"end":[61,70],"kind":"notation","pexpr":337,"start":[61,65],"value":"expr - "},{"children":[288],"end":[61,71],"kind":"(","pexpr":337,"start":[61,53]},{"children":[289],"end":[61,71],"kind":"notation","pexpr":337,"start":[61,53],"value":"("},{"children":[283,290],"end":[61,71],"kind":"app","pexpr":338,"start":[61,49]},{"end":[61,75],"kind":"ident","pexpr":339,"start":[61,74],"value":"ε"},{"children":[291,292],"end":[61,75],"kind":"notation","pexpr":342,"start":[61,72],"value":"expr ≤ "}],"comments":[{"end":[5,0],"start":[1,2],"text":"\n -----------------------------------------------------------\n  Security games as pmfs \n -----------------------------------------------------------\n"},{"end":[18,0],"start":[14,2],"text":"\n  G1 = public key space, G2 = private key space, \n  M = message space, C = ciphertext space \n  A_state = type for state A1 passes to A2\n"},{"end":[24,178],"start":[24,46],"text":" Should have G1 else how can A2 do further encryptions? Any general result about encryptions before getting challenge ciphertext...?"},{"end":[29,0],"start":[26,2],"text":" \n  Executes the a public-key protocol defined by keygen,\n  encrypt, and decrypt\n"},{"end":[30,62],"start":[30,2],"text":" Simulates running the program and returns 1 with prob 1 if:"},{"end":[31,38],"start":[31,2],"text":" `Pr[D(sk, E(pk, m)) = m] = 1` holds"},{"end":[32,60],"start":[32,42],"text":" given a message m"},{"end":[34,52],"start":[34,16],"text":" produces a public / secret key pair"},{"end":[35,43],"start":[35,23],"text":" encrypts m using pk"},{"end":[36,95],"start":[36,46],"text":" decrypts using sk and checks for equality with m"},{"end":[41,0],"start":[38,2],"text":" \n  A public-key encryption protocol is correct if decryption undoes \n  encryption with probability 1\n"},{"end":[43,175],"start":[43,85],"text":" This chain of encryption/decryption matches the monadic actions in the `enc_dec` function"},{"end":[48,0],"start":[45,2],"text":" \n  The semantic security game. \n  Returns 1 if the attacker A2 guesses the correct bit\n"},{"end":[58,66],"start":[58,2],"text":" SSG(A) denotes the event that A wins the semantic security game"}],"expr":[null,{"sort":1},{"annotation":{"args":[1],"name":"no_univ"}},{"const":["decidable_eq",[]]},{"local":{"bi":4,"name":["_ffresh",2],"pp":"M","type":1}},{"app":[3,4]},{"const":["decidable_eq",[1]]},{"local":{"bi":4,"name":["_ffresh",2],"pp":"M","type":1}},{"app":[6,7]},{"const":["pmf",[]]},{"local":{"bi":4,"name":["_ffresh",0],"pp":"G1","type":1}},{"local":{"bi":4,"name":["_ffresh",1],"pp":"G2","type":1}},{"const":["prod",[]]},{"app":[12,10]},{"app":[13,11]},{"app":[9,14]},{"const":["pmf",[0]]},{"const":["prod",[0,0]]},{"local":{"bi":4,"name":["_ffresh",0],"pp":"G1","type":1}},{"app":[17,18]},{"local":{"bi":4,"name":["_ffresh",1],"pp":"G2","type":1}},{"app":[19,20]},{"app":[16,21]},{"local":{"bi":4,"name":["_ffresh",0],"pp":"G1","type":1}},{"local":{"bi":4,"name":["_ffresh",2],"pp":"M","type":1}},{"const":["pmf",[]]},{"local":{"bi":4,"name":["_ffresh",3],"pp":"C","type":1}},{"app":[25,26]},{"Pi":{"bi":0,"body":27,"dom":24,"name":"ᾰ"}},{"Pi":{"bi":0,"body":28,"dom":23,"name":"ᾰ"}},{"const":["pmf",[0]]},{"local":{"bi":4,"name":["_ffresh",3],"pp":"C","type":1}},{"app":[30,31]},{"Pi":{"bi":0,"body":32,"dom":7,"name":"ᾰ"}},{"Pi":{"bi":0,"body":33,"dom":18,"name":"ᾰ"}},{"local":{"bi":4,"name":["_ffresh",1],"pp":"G2","type":1}},{"local":{"bi":4,"name":["_ffresh",3],"pp":"C","type":1}},{"local":{"bi":4,"name":["_ffresh",2],"pp":"M","type":1}},{"Pi":{"bi":0,"body":37,"dom":36,"name":"ᾰ"}},{"Pi":{"bi":0,"body":38,"dom":35,"name":"ᾰ"}},{"Pi":{"bi":0,"body":7,"dom":31,"name":"ᾰ"}},{"Pi":{"bi":0,"body":40,"dom":20,"name":"ᾰ"}},{"local":{"bi":4,"name":["_ffresh",0],"pp":"G1","type":1}},{"const":["pmf",[]]},{"local":{"bi":4,"name":["_ffresh",2],"pp":"M","type":1}},{"local":{"bi":4,"name":["_ffresh",2],"pp":"M","type":1}},{"local":{"bi":4,"name":["_ffresh",4],"pp":"A_state","type":1}},{"const":["prod",[]]},{"app":[47,45]},{"app":[48,46]},{"const":["prod",[]]},{"app":[50,44]},{"app":[51,49]},{"app":[43,52]},{"Pi":{"bi":0,"body":53,"dom":42,"name":"ᾰ"}},{"const":["pmf",[0]]},{"const":["prod",[0,0]]},{"app":[56,7]},{"local":{"bi":4,"name":["_ffresh",4],"pp":"A_state","type":1}},{"app":[57,58]},{"app":[57,59]},{"app":[55,60]},{"Pi":{"bi":0,"body":61,"dom":18,"name":"ᾰ"}},{"local":{"bi":4,"name":["_ffresh",3],"pp":"C","type":1}},{"local":{"bi":4,"name":["_ffresh",4],"pp":"A_state","type":1}},{"const":["pmf",[]]},{"const":["zmod",[]]},{"prenum":{"args":[],"value":"2"}},{"app":[66,67]},{"app":[65,68]},{"Pi":{"bi":0,"body":69,"dom":64,"name":"ᾰ"}},{"Pi":{"bi":0,"body":70,"dom":63,"name":"ᾰ"}},{"const":["pmf",[0]]},{"const":["bit0",[0]]},{"const":["nat",[]]},{"app":[73,74]},{"const":[["nat","has_add"],[]]},{"app":[75,76]},{"const":[["has_one","one"],[0]]},{"app":[78,74]},{"const":[["nat","has_one"],[]]},{"app":[79,80]},{"app":[77,81]},{"app":[66,82]},{"app":[72,83]},{"Pi":{"bi":0,"body":84,"dom":58,"name":"ᾰ"}},{"Pi":{"bi":0,"body":85,"dom":31,"name":"ᾰ"}},{"local":{"bi":4,"name":["_ffresh",2],"pp":"M","type":1}},{"const":["pmf",[]]},{"const":["zmod",[]]},{"prenum":{"args":[],"value":"2"}},{"app":[89,90]},{"app":[88,91]},{"const":[["has_bind","bind"],[]]},{"annotation":{"args":[93],"name":"no_info"}},{"local":{"bi":0,"name":["_ffresh",6],"pp":"keygen","type":22}},{"app":[94,95]},{"const":[[4,"_",102],[]]},{"const":[["has_bind","bind"],[]]},{"annotation":{"args":[98],"name":"no_info"}},{"local":{"bi":0,"name":["_ffresh",7],"pp":"encrypt","type":34}},{"var":0},{"field_notation":{"args":[101],"field":[],"idx":1}},{"app":[100,102]},{"local":{"bi":0,"name":"m","pp":"m","type":87}},{"app":[103,104]},{"app":[99,105]},{"const":[[4,"_",105],[]]},{"const":[["has_pure","pure"],[]]},{"const":["ite",[]]},{"const":["eq",[]]},{"local":{"bi":0,"name":["_ffresh",8],"pp":"decrypt","type":41}},{"var":1},{"field_notation":{"args":[112],"field":[],"idx":2}},{"app":[111,113]},{"var":0},{"app":[114,115]},{"app":[110,116]},{"local":{"bi":0,"name":"m","pp":"m","type":87}},{"app":[117,118]},{"app":[109,119]},{"prenum":{"args":[],"value":"1"}},{"app":[120,121]},{"prenum":{"args":[],"value":"0"}},{"app":[122,123]},{"app":[108,124]},{"lam":{"bi":0,"body":125,"dom":107,"name":"c"}},{"app":[106,126]},{"lam":{"bi":0,"body":127,"dom":97,"name":"k"}},{"app":[96,128]},{"const":[[4,"_",104],[]]},{"local":{"bi":0,"name":"k","pp":"k","type":130}},{"const":[[4,"_",107],[]]},{"local":{"bi":0,"name":"c","pp":"c","type":132}},{"local":{"bi":0,"name":"k","pp":"k","type":97}},{"field_notation":{"args":[134],"field":[],"idx":1}},{"app":[100,135]},{"app":[136,104]},{"const":[[4,"_",108],[]]},{"local":{"bi":0,"name":"pure","pp":"pure","type":138}},{"local":{"bi":0,"name":"k","pp":"k","type":97}},{"const":[[4,"_",110],[]]},{"local":{"bi":0,"name":"k","pp":"k","type":141}},{"field_notation":{"args":[142],"field":[],"idx":2}},{"const":[[4,"_",109],[]]},{"local":{"bi":0,"name":"decrypt","pp":"decrypt","type":144}},{"app":[145,143]},{"local":{"bi":0,"name":"c","pp":"c","type":107}},{"const":[[4,"_",111],[]]},{"local":{"bi":0,"name":"c","pp":"c","type":148}},{"app":[146,149]},{"app":[110,150]},{"const":[[4,"_",112],[]]},{"local":{"bi":0,"name":"m","pp":"m","type":152}},{"app":[151,153]},{"app":[109,154]},{"app":[155,121]},{"app":[156,123]},{"app":[139,157]},{"sort":0},{"local":{"bi":4,"name":["_ffresh",2],"pp":"M","type":1}},{"const":["enc_dec",[]]},{"local":{"bi":0,"name":["_ffresh",6],"pp":"keygen","type":22}},{"app":[161,162]},{"local":{"bi":0,"name":["_ffresh",7],"pp":"encrypt","type":34}},{"app":[163,164]},{"local":{"bi":0,"name":["_ffresh",8],"pp":"decrypt","type":41}},{"app":[165,166]},{"local":{"bi":0,"name":"m","pp":"m","type":160}},{"app":[167,168]},{"const":[["has_pure","pure"],[]]},{"prenum":{"args":[],"value":"1"}},{"app":[170,171]},{"const":["eq",[]]},{"app":[173,169]},{"app":[174,172]},{"var":0},{"app":[167,176]},{"app":[173,177]},{"app":[178,172]},{"Pi":{"bi":0,"body":179,"dom":160,"name":"m"}},{"const":["pmf",[]]},{"const":["zmod",[]]},{"prenum":{"args":[],"value":"2"}},{"app":[182,183]},{"app":[181,184]},{"const":[["has_bind","bind"],[]]},{"annotation":{"args":[186],"name":"no_info"}},{"local":{"bi":0,"name":["_ffresh",6],"pp":"keygen","type":22}},{"app":[187,188]},{"const":[[4,"_",120],[]]},{"const":[["has_bind","bind"],[]]},{"annotation":{"args":[191],"name":"no_info"}},{"local":{"bi":0,"name":["_ffresh",9],"pp":"A1","type":62}},{"var":0},{"field_notation":{"args":[194],"field":[],"idx":1}},{"app":[193,195]},{"app":[192,196]},{"const":[[4,"_",123],[]]},{"const":[["has_bind","bind"],[]]},{"annotation":{"args":[199],"name":"no_info"}},{"const":["uniform_2",[]]},{"app":[200,201]},{"const":[[4,"_",126],[]]},{"const":[["has_bind","bind"],[]]},{"annotation":{"args":[204],"name":"no_info"}},{"local":{"bi":0,"name":["_ffresh",7],"pp":"encrypt","type":34}},{"var":2},{"field_notation":{"args":[207],"field":[],"idx":1}},{"app":[206,208]},{"const":["ite",[]]},{"const":["eq",[]]},{"var":0},{"app":[211,212]},{"prenum":{"args":[],"value":"0"}},{"app":[213,214]},{"app":[210,215]},{"var":1},{"field_notation":{"args":[217],"field":[],"idx":1}},{"app":[216,218]},{"var":1},{"field_notation":{"args":[220],"field":[],"idx":2}},{"field_notation":{"args":[221],"field":[],"idx":1}},{"app":[219,222]},{"app":[209,223]},{"app":[205,224]},{"const":[[4,"_",129],[]]},{"const":[["has_bind","bind"],[]]},{"annotation":{"args":[227],"name":"no_info"}},{"local":{"bi":0,"name":["_ffresh",10],"pp":"A2","type":86}},{"var":0},{"app":[229,230]},{"var":2},{"field_notation":{"args":[232],"field":[],"idx":2}},{"field_notation":{"args":[233],"field":[],"idx":2}},{"app":[231,234]},{"app":[228,235]},{"const":[[4,"_",132],[]]},{"const":[["has_pure","pure"],[]]},{"const":[["has_add","add"],[]]},{"const":[["has_add","add"],[]]},{"prenum":{"args":[],"value":"1"}},{"app":[240,241]},{"var":2},{"app":[242,243]},{"app":[239,244]},{"var":0},{"app":[245,246]},{"app":[238,247]},{"lam":{"bi":0,"body":248,"dom":237,"name":"b'"}},{"app":[236,249]},{"lam":{"bi":0,"body":250,"dom":226,"name":"c"}},{"app":[225,251]},{"lam":{"bi":0,"body":252,"dom":203,"name":"b"}},{"app":[202,253]},{"lam":{"bi":0,"body":254,"dom":198,"name":"m"}},{"app":[197,255]},{"lam":{"bi":0,"body":256,"dom":190,"name":"k"}},{"app":[189,257]},{"const":[[4,"_",122],[]]},{"local":{"bi":0,"name":"k","pp":"k","type":259}},{"const":[[4,"_",125],[]]},{"local":{"bi":0,"name":"m","pp":"m","type":261}},{"local":{"bi":0,"name":"k","pp":"k","type":190}},{"field_notation":{"args":[263],"field":[],"idx":1}},{"app":[193,264]},{"const":[[4,"_",128],[]]},{"local":{"bi":0,"name":"b","pp":"b","type":266}},{"const":[[4,"_",131],[]]},{"local":{"bi":0,"name":"c","pp":"c","type":268}},{"local":{"bi":0,"name":"k","pp":"k","type":190}},{"field_notation":{"args":[270],"field":[],"idx":1}},{"app":[206,271]},{"local":{"bi":0,"name":"b","pp":"b","type":203}},{"app":[211,273]},{"app":[274,214]},{"app":[210,275]},{"local":{"bi":0,"name":"m","pp":"m","type":198}},{"field_notation":{"args":[277],"field":[],"idx":1}},{"app":[276,278]},{"local":{"bi":0,"name":"m","pp":"m","type":198}},{"field_notation":{"args":[280],"field":[],"idx":2}},{"field_notation":{"args":[281],"field":[],"idx":1}},{"app":[279,282]},{"app":[272,283]},{"const":[[4,"_",134],[]]},{"local":{"bi":0,"name":"b'","pp":"b'","type":285}},{"local":{"bi":0,"name":"c","pp":"c","type":226}},{"app":[229,287]},{"local":{"bi":0,"name":"m","pp":"m","type":198}},{"field_notation":{"args":[289],"field":[],"idx":2}},{"field_notation":{"args":[290],"field":[],"idx":2}},{"app":[288,291]},{"const":[[4,"_",135],[]]},{"local":{"bi":0,"name":"pure","pp":"pure","type":293}},{"local":{"bi":0,"name":"b","pp":"b","type":203}},{"const":[[4,"_",136],[]]},{"local":{"bi":0,"name":"b","pp":"b","type":296}},{"app":[242,297]},{"local":{"bi":0,"name":"b'","pp":"b'","type":237}},{"app":[239,298]},{"const":[[4,"_",137],[]]},{"local":{"bi":0,"name":"b'","pp":"b'","type":301}},{"app":[300,302]},{"app":[294,303]},{"const":["SSG",[]]},{"local":{"bi":0,"name":["_ffresh",6],"pp":"keygen","type":22}},{"app":[305,306]},{"local":{"bi":0,"name":["_ffresh",7],"pp":"encrypt","type":34}},{"app":[307,308]},{"local":{"bi":0,"name":["_ffresh",9],"pp":"A1","type":62}},{"app":[309,310]},{"local":{"bi":0,"name":["_ffresh",10],"pp":"A2","type":86}},{"app":[311,312]},{"prenum":{"args":[],"value":"1"}},{"app":[313,314]},{"const":["nnreal",[]]},{"sort":0},{"const":[["has_abs","abs"],[]]},{"const":["SSG",[]]},{"local":{"bi":0,"name":["_ffresh",6],"pp":"keygen","type":22}},{"app":[319,320]},{"local":{"bi":0,"name":["_ffresh",7],"pp":"encrypt","type":34}},{"app":[321,322]},{"local":{"bi":0,"name":["_ffresh",9],"pp":"A1","type":62}},{"app":[323,324]},{"local":{"bi":0,"name":["_ffresh",10],"pp":"A2","type":86}},{"app":[325,326]},{"prenum":{"args":[],"value":"1"}},{"app":[327,328]},{"prenum":{"args":[],"value":"1"}},{"prenum":{"args":[],"value":"2"}},{"const":[["has_div","div"],[]]},{"app":[332,330]},{"app":[333,331]},{"const":[["has_sub","sub"],[]]},{"app":[335,329]},{"app":[336,334]},{"app":[318,337]},{"local":{"bi":0,"name":"ε","pp":"ε","type":316}},{"const":[["has_le","le"],[]]},{"app":[340,338]},{"app":[341,339]}],"file":1,"level":["0",{"suc":0}]}